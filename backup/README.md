# Automatization of data handling for Toxicokinetic report
#### Video Demo:  <URL HERE>
## Description:
**The purpose of this program is to take the Excel file generated by an Analyst 1.6.2 software and process the data, so it can be used in the making of a Good Laboratory Practice compliant Study Report creation.**
### Command-Line Arguments
This program takes three required command-line arguments. The path of the Excel of the input data, the name of the test item (usually the active pharmaceutical ingredient) and some basic data.
Originally, I wanted to parse the Study Plan for the test item name and the basic, but as it may vary from Plan to Plan I felt it vulnerable.
### Main function
The project consists of one main function and it has four modules written by me.
The `main` function steps through the sheets of the input Excel, collecting data into dataframes of the pandas module while simultaneously doing data handling
(taking the type, the concentration and calculating the accuracy from the convoluted sample name, rounding to three significant digits, getting the names of the sheets, reading the basic data file).
The collector dataframe is then separated into smaller dataframes, whether the data is a calibrator, a quality control, a dilution quality control or a study sample.
The calibrator, quality control and dilution quality control samples are passed to the `cal_qc` module while the quality control and dilution quality control samples also collected into a separate dataframe which is passed to the `btwn_rns` (between runs) module when all runs have been processed.
The study samples are passed to the `concentrations` module for analysis.
### Calibrator and quality control samples
#### In study validation
The `cal_qc_excel` function writes the appropriately formatted data to the output Excel, and marks all samples that are out of the acceptance criteria (which is based on the newest guideline (March 19, 2024): https://www.ema.europa.eu/en/ich-m10-bioanalytical-method-validation-scientific-guideline).
#### Between runs
The `between_runs` function calculates the mean, the accuracy and the coefficient of variation for every concentration level, then writes the appropriately formatted data to the output Excel.
#### Concentrations of Study samples
The `concentrations` function takes all the study sample concentration and calculates the mean and the coefficient of variation for every group at every time point then writes the appropriately formatted data to the output Excel. The `add_cols` function was necessary as the time point wouldn't be in order otherwise. The data is also plotted, where the x-axis is time, the y-axis is the measured concentration, which *could* be used to calculate the area under the plasma drug concentration-time curve (AUC), but it is actually done by a dedicated and validated software, as that is accepted by the regulatory authorities.
#### Formatting
This module only contains the different formattings of the **xlsxwriter** engine, as the other functions got really long and confusing with all this formatting there. The `set_column` and `conditional_format` methods were left in their original places, as I couldn't make them shorter.
### Unittest
The functions of the `project` module is unittested in `test_project`. The `command_args` function is tested with mock arguments, the `get_sheets` function is tested with two mock excel files, the `get_data` function is tested with one mock data file, the `add_columns` function is tested with a mock dataframe and finally `sign_round` function is tested with numbers
### Code formatting
Every page was formatted by `black`.
